---
import { Image } from "astro:assets";

import ProjectNatanya from "./Items/ProjectNatanya.astro";
import ProjectNatatoko from "./Items/ProjectNatatoko.astro";
import ProjectHeader from "./ProjectHeader.astro";
import ProjectNatauang from "./Items/ProjectNatauang.astro";
---

<section class="relative pt-16 lg:pt-32 xl:pt-36 2xl:pt-[11rem]" id="projects">
  <!-- mesh -->
  <Image
    format="webp"
    id="mesh-project-section-top"
    loading="lazy"
    src="/images/mesh.png"
    alt=""
    width="1400"
    height="1089"
    style="opacity: 0;"
    class="aspect-auto absolute right-0 top-[-150px] hidden min-w-[554px] sm:left-[550px] sm:top-[-150px] sm:block lg:min-w-[1400px]"
  />

  <ProjectHeader />

  <div class="mt-20 px-0 sm:px-8 md:px-12 lg:mt-24 xl:mt-32">
    <ProjectNatauang />
  </div>

  <!-- 
  <div class="mt-20 px-0 sm:px-8 md:px-12 lg:mt-24 xl:mt-32">
    <ProjectNatanya />
  </div> -->

  <div class="relative">
    <Image
      format="webp"
      id="mesh-project-section-bottom"
      loading="lazy"
      src="/images/mesh.png"
      alt=""
      width="1400"
      height="1089"
      style="opacity: 0;"
      class="aspect-auto absolute left-[-250px] top-[-700px] hidden w-auto sm:block sm:min-h-[1400px]"
    />
  </div>

  <div class="mt-0 px-0 sm:mt-12 sm:px-8 md:px-12 lg:mt-24 xl:mt-32">
    <ProjectNatatoko />
    <div class="overlay-natatoko absolute bottom-0 right-0 hidden w-screen sm:block sm:h-[2050px] xl:h-[2000px]"></div>
  </div>

  <div class="sm:pt-32"></div>
</section>

<script>
  import { animate, inView, spring, stagger } from "motion";

  const defaultEasing = [0.17, 0.67, 0.83, 0.67] as const;

  const projects = ["natauang", "natatoko"];

  projects.forEach((project) => {
    inView(`#project-${project}`, () => {
      animate(`#project-${project}`, { y: [50, 0], opacity: [0, 1] }, { ease: "easeInOut", duration: 0.3 });
    });

    inView(`#project-${project}-slider`, () => {
      animate(
        `.project-slider-item-${project}`,
        { x: [50, 0], opacity: [0, 1] },
        { ease: "easeInOut", duration: 0.5, delay: stagger(0.1) },
      );
    });
  });

  const buttons = [
    "#btn-live-in-production-natauang",
    "#btn-live-in-production-natatoko-com",
    "#btn-live-in-production-natanya-app",
  ];

  buttons.forEach((btn) => {
    inView(`${btn}`, () => {
      animate(
        `${btn}-arrow-wrapper`,
        {
          opacity: 1,
          boxShadow: `10px 11px 6px rgba(0, 0, 0, 0.01), 6px 6px 5px rgba(0, 0, 0, 0.05), 3px 3px 4px rgba(0, 0, 0, 0.09), 1px 1px 2px rgba(0, 0, 0, 0.1), 0px 0px 0px rgba(0, 0, 0, 0.1)`,
        },
        { delay: 0.3, duration: 0.3, type: spring, ease: defaultEasing },
      );

      animate(
        `${btn}-arrow`,
        { transform: ["translate(-150%, 150%)", "translate(0%, 0%)"], opacity: [0, 1] },
        { delay: 0.4, ease: "easeInOut" },
      );
    });
  });
</script>

<style>
  .overlay-natatoko {
    background: radial-gradient(
        136.64% 61.58% at 89.55% 104.49%,
        rgba(225, 29, 72, 0.17) 0%,
        rgba(255, 241, 242, 0) 100%
      ),
      radial-gradient(21.08% 15.61% at 21.46% 19.85%, rgba(225, 29, 72, 0.1) 0%, rgba(255, 241, 242, 0) 100%);
  }

  @media (max-width: 1268px) {
    .overlay-natatoko {
      background: radial-gradient(
          136.64% 61.58% at 89.55% 104.49%,
          rgba(225, 29, 72, 0.17) 0%,
          rgba(255, 241, 242, 0) 100%
        ),
        radial-gradient(21.08% 15.61% at 21.46% 19.85%, rgba(225, 29, 72, 0.45) 0%, rgba(255, 241, 242, 0) 100%);
    }
  }
</style>
